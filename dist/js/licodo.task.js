licodo.task=function(){var o,i,l,t,a,d,s,e={main_html:String()+'<ul class = "licodo-task-head"><li id = "licodo-task-all"  class = "licodo-task-hall licodo-task-processOn"></li><li id = "licodo-task-done" class = "licodo-task-hdone"></li><li id = "licodo-task-doing" class = "licodo-task-hdoing"></li></ul><div class = "licodo-task-main"></div><div class = "licodo-task-new"><span class = "licodo-task-add">＋</span><span class = "licodo-task-newTitle">新建任务</span></div>'},c={text_html:"main_html",infoStr:null};return t=function(o){o.sort(function(o,i){return o.replace(/-/g,"")-i.replace(/-/g,"")})},d=function(o,i,t,a){var d=$(".licodo-task-on")[0],s=d.id,e=parseInt(s.replace(/\D/g,"")),c=licodo.data.getStorage("task"),n=licodo.util.getObjByKey(c,"id",e);o?n.isFinish="done":(n.name=licodo.util.filterXSS(i),n.date=licodo.util.filterXSS(t),n.content=licodo.util.filterXSS(a)),licodo.data.saveStorage(c),l($(".licodo-classify-on")[0]),addClass($("#licodo-task-item"+e)[0],"licodo-task-on")},a=function(o,i,t){var a,d,s=$(".licodo-classify-on")[0],e=s.parentNode.id,c=parseInt(e.replace(/\D/g,"")),n=licodo.data.getStorage("task"),r=licodo.data.getStorage("cate"),k=licodo.data.getStorage("childCate"),u={id:n[n.length-1].id+1,name:licodo.util.filterXSS(o),parent:0,isFinish:"doing",date:licodo.util.filterXSS(i),content:licodo.util.filterXSS(t)};n.push(u),licodo.data.saveStorage(n),hasClass(s.parentNode,"licodo-classify-item")?(a=licodo.util.getObjByKey(r,"id",c),a.taskChild.push(u.id),licodo.data.saveStorage(r),licodo.classify.makeItems(),licodo.util.addClassOn($("#licodo-classify-item"+c)[0].childNodes[0],"licodo-classify-on")):(d=licodo.util.getObjByKey(k,"id",c),d.taskChild.push(u.id),licodo.data.saveStorage(k),licodo.classify.makeItems(),licodo.util.addClassOn($("#licodo-classify-subItem"+c)[0].childNodes[0],"licodo-classify-on")),licodo.util.addClassOn($("#licodo-task-all")[0],"licodo-task-processOn"),l($(".licodo-classify-on")[0]),addClass($("#licodo-task-item"+u.id)[0],"licodo-task-on")},l=function(o,i){var l,a=o.parentNode.id,d=parseInt(a.replace(/\D/g,"")),s=licodo.data.getStorage("cate"),e=licodo.data.getStorage("childCate"),c=licodo.data.getStorage("task"),n=[],r=[],k=[],u="";node=hasClass(o.parentNode,"licodo-classify-item")?licodo.util.getObjByKey(s,"id",d):licodo.util.getObjByKey(e,"id",d),0==node.taskChild.length&&(u+='<p class = "licodo-task-noTask">目前还没有任务哦</p>');for(var g=0;g<node.taskChild.length;g++)l=licodo.util.getObjByKey(c,"id",node.taskChild[g]),r.push(l);if(("done"==i||"doing"==i)&&(r=licodo.util.getObjsByKey(r,"isFinish",i),0==r.length))switch(i){case"done":u='<p class = "licodo-task-noTask">还没有已完成任务哦</p>';break;case"doing":u='<p class = "licodo-task-noTask">还没有未完成任务哦</p>'}for(var g=0;g<r.length;g++)n.push(r[g].date);n=uniqArray1(n),t(n);for(var f=0;f<n.length;f++){u+='<p class = "licodo-task-time">'+n[f]+'</p><ul class = "licodo-task-ul" id = "licodo-task-ul'+f+'">',k=licodo.util.getObjsByKey(r,"date",n[f]);for(var h=0;h<k.length;h++)u+='<li class = "licodo-task-item licodo-task-'+k[h].isFinish+'" id = "licodo-task-item'+k[h].id+'">'+k[h].name+"</li>";u+="</ul>"}$(".licodo-task-main")[0].innerHTML=u},i=function(){hasClass($(".licodo-classify-main")[0],"licodo-classify-on")?(c.infoStr="请选择所属分类",licodo.info.configModule({infoStr:c.infoStr})):(c.text_html="sub_html",licodo.text.configModule({text_html:c.text_html}))},onclickItem=function(){var o=arguments[0]||window.event,i=o.srcElement?o.srcElement:o.target;return hasClass(i,"licodo-task-item")?(licodo.util.addClassOn(i,"licodo-task-on"),licodo.util.mobileFit()&&licodo.shell.showPage($(".licodo-mobile-text")[0]),void licodo.text.makeText(i)):!1},s=function(){var o=arguments[0]||window.event,i=o.srcElement?o.srcElement:o.target,t=i.id,a=t.substring(12,t.length);hasClass(i,"licodo-task-head")||(licodo.util.addClassOn(i,"licodo-task-processOn"),hasClass($(".licodo-classify-on")[0],"licodo-classify-itemName")?(l($(".licodo-classify-on")[0],a),$("#licodo-task-ul0")[0]?(addClass($("#licodo-task-ul0")[0].childNodes[0],"licodo-task-on"),licodo.text.makeText($("#licodo-task-ul0")[0].childNodes[0])):licodo.text.makeText()):(c.infoStr="请选择所属分类",licodo.info.configModule({infoStr:c.infoStr})))},o=function(o){o.innerHTML=e.main_html,l($("#licodo-classify-item0 .licodo-classify-itemName")[0]),$("#licodo-task-ul0")[0]&&addClass($("#licodo-task-ul0")[0].childNodes[0],"licodo-task-on"),addClickEvent($(".licodo-task-new")[0],i),addClickEvent($(".licodo-task-main")[0],onclickItem),addClickEvent($(".licodo-task-head")[0],s)},{modifyTask:d,addTask:a,initModule:o,makeTask:l}}();