licodo.overlay=function(){var o,l,e,i,a,t,d,c,n={main_html:String()+'<div class = "licodo-overlay"><div class = "licodo-overlay-page"></div></div>',new_html:String()+'<form class = "licodo-overlay-new, licodo-overlay-form"><div class = "licodo-overlay-title"><span class = "licodo-overlay-info">请输入任务名称:</span><input class = "licodo-overlay-input" type = "text" value=""/><span class = "licodo-overlay-delete">x</span></div><div class = "licodo-overlay-action"><input class = "licodo-overlay-cancel btn"  type = "button" value = "取消"><input class = "licodo-overlay-confirm btn" type = "button" value ="确认"></div></form>',trash_html:String()+'<form class = "licodo-overlay-trash, licodo-overlay-form"><div class = "licodo-overlay-title"><span class = "licodo-overlay-info"></span><span class = "licodo-overlay-delete">x</span></div><div class = "licodo-overlay-action"><input class = "licodo-overlay-cancel btn"  type = "button" value = "取消"><input class = "licodo-overlay-confirm btn" type = "button" value ="确认"></div></form>',settable_map:{overMode:null,overBool:!1,classifyMain:null,target:null},overMode:null,overBool:!1,classifyMain:null,target:null},r={infoStr:null},e={};return setSelectorMap=function(){e={page:$(".licodo-overlay-page")[0]||"",over_delete:$(".licodo-overlay-delete")[0]||"",over_cancel:$(".licodo-overlay-cancel")[0]||"",over_confirm:$(".licodo-overlay-confirm")[0]||"",over_input:$(".licodo-overlay-input")[0]||""}},mainHtmlAdd=function(){var o=r.contain;o.innerHTML=n.overBool?n.main_html:"",setSelectorMap()},subHtmlAdd=function(o){if(!n.overBool)return!1;if(1===o)e.page.innerHTML=n.new_html,t(),addClickEvent(e.over_confirm,a);else if(2===o)e.page.innerHTML=n.trash_html,$(".licodo-overlay-info")[0].innerHTML="将永久删除，are you OK？",t(),addClickEvent(e.over_confirm,d);else{if(3!==o)return!1;e.page.innerHTML=n.trash_html,$(".licodo-overlay-info")[0].innerHTML="确定已完成任务？",t(),addClickEvent(e.over_confirm,c)}},t=function(){setSelectorMap(),addClickEvent(e.over_cancel,i),addClickEvent(e.over_delete,i)},l=function(l){licodo.util.setConfigMap({input_map:l,settable_map:n.settable_map,config_map:n}),o()},i=function(){n.overMode=null,n.overBool=!1,mainHtmlAdd()},a=function(){var o=$(".licodo-overlay-input")[0].value;""!==o?(licodo.classify.addItems(),i()):r.infoStr="您的任务名为空",licodo.info.configModule({infoStr:r.infoStr})},d=function(){var o,l,e,a,t,d,c=n.target,r=c.parentNode.id,s=parseInt(r.replace(/\D/g,"")),v=licodo.data.getStorage("cate"),u=licodo.data.getStorage("childCate"),y=licodo.data.getStorage("task");if(hasClass(c.parentNode,"licodo-classify-item")){o=licodo.util.getObjByKey(v,"id",s),d=licodo.util.getIndexByKey(v,"id",s);for(var f=0;f<v[d].child.length;f++){e=licodo.util.getIndexByKey(u,"id",v[d].child[f]);for(var p=0;p<u[e].taskChild.length;p++)t=licodo.util.getIndexByKey(y,"id",u[e].taskChild[p]),y.splice(t,1);u.splice(e,1)}for(var m=0;m<v[d].taskChild.length;m++)a=licodo.util.getIndexByKey(y,"id",v[d].taskChild[m]),y.splice(a,1);v.splice(d,1)}else{d=licodo.util.getIndexByKey(u,"id",s),o=licodo.util.getObjByKey(u,"id",s),l=licodo.util.getObjByKey(v,"id",o.parent);for(var f=0;f<u[d].taskChild.length;f++)a=licodo.util.getIndexByKey(y,"id",u[d].taskChild[f]),y.splice(a,1);l.child.splice(l.child.indexOf(u[d].id),1),u.splice(d,1)}licodo.data.saveStorage(y),licodo.data.saveStorage(v),licodo.data.saveStorage(u),licodo.classify.makeItems(),licodo.task.makeTask($(".licodo-classify-on")[0]),addClass($("#licodo-task-ul0")[0].childNodes[0],"licodo-task-on"),licodo.text.makeText($("#licodo-task-ul0")[0].childNodes[0]),i()},c=function(){licodo.task.modifyTask(!0),i()},o=function(o){o&&(r.contain=o,setSelectorMap()),mainHtmlAdd(),subHtmlAdd(n.overMode)},{initModule:o,configModule:l}}();